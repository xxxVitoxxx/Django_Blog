{% extends 'blog_app/base.html' %}
{% load static %}

{% block css %}
  <link rel="stylesheet" href="{% static 'article/css/article.css' %}">
{% endblock %}

{% block title %}閱讀文章{% endblock %}

{% block content %}
  <div class="container">
  <div class="row">
    <div class="col1">
      <h3>{{ article.title }}</h3>
    </div>
    <div class="col-9"></div>
    {% if user.is_authenticated %}
    <div class="col1">
      <a class="btn btn-sm btn-dark" href="{% url 'article:articleUpdate' article.id %}">修改內容</a>
    </div>
    {% endif %}
  </div>
  </div>
  <p>發表時間: {{ article.pubDateTime|date:'Y-m-d H:i' }}</p>
  <div class="articleContent">{{ article.content }}</div>
  <p>
    <i class="fas fa-thumbs-up" style="width: 1.6em;">{{ article.likes.count }}</i>
    {% if user.is_authenticated %}
      <a href="{% url 'article:articleLike' article.id %}">讚</a>
    {% endif %}
  <!--
    使用者一篇文章可以按一次讚，如果已按讚
     1. 不會出現  讚的連結
     2. 出現收回讚的連結
  -->
    <span>共{{ comments|length }}則留言</span>
  </p>
  {% for comment in comments %}
    <div class="mt-1">
      <span class="commentAuthor">{{ comment.user.username }}:</span>
      {% if comment.user != user %}
        <span class="h6">{{ comment.content }}</span>
      {% else %}
        <form method="post" action="{% url 'article:commentUpdate' comment.id %}">
          {% csrf_token %}
          <input type="text" name="comment" value="{{ comment.content }}">
          <input class="btn" type="submit" value="修改">
        </form>
      {% endif %}
      <br>
      <span class="text-secondary"><small>{{ comment.pubDateTime|date:'Y-m-d H:i' }}</small></span>
    </div>
  {% endfor %}

  {% if user.is_authenticated %}
    <br>
    <form method="post" action="{% url 'article:commentCreate' article.id %}">
      {% csrf_token %}
      <input type="text" name="comment" placeholder="留言">
      <input class="btn btn-sm btn-dark" type="submit" value="送出">
    </form>
    <br><br>
  {% endif %}

{% endblock %}